# 表格提取工具 - 使用指南

## ? 项目简介

这是一个基于**豆包AI + 手动文本**的表格提取工具。你不需要上传文件，只需要：
1. 复制提示词给豆包
2. 把豆包返回的纯文本粘贴进来
3. 自动生成Excel文件

## ? 快速开始

### 1. 环境准备

确保你已经安装了：
- Python 3.11
- Node.js 16+

### 2. 后端启动

```bash
# 进入后端目录
cd backend

# 激活虚拟环境（如果还没创建）
python -m venv .venv
.venv\Scripts\activate  # Windows
# 或 source .venv/bin/activate  # Linux/Mac

# 安装依赖
pip install -r requirements.txt

# 初始化数据库（首次运行）
python init_db.py

# 启动后端服务
python app.py
```

后端将在 `http://localhost:5000` 运行。

### 3. 前端启动

打开**新的终端窗口**：

```bash
# 进入前端目录
cd frontend

# 安装依赖（首次运行）
npm install

# 启动前端服务
npm run dev
```

前端将在 `http://localhost:5173` 运行。

## ? 使用流程

### 第一步：注册/登录

1. 打开浏览器访问 `http://localhost:5173`
2. 如果没有账号，点击"注册"创建账号
   - 用户名不能重复
   - 密码至少6位
3. 登录后进入主页面

### 第二步：复制提示词给豆包

1. 在主页面的**步骤一**区域，你会看到一段提示词
2. 点击"**复制提示词**"按钮
3. 打开豆包（网页版或APP），粘贴提示词
4. 上传你的PDF文件给豆包
5. 等待豆包处理并返回结果

**提示词内容示例：**
```
提取出我上传的文件中的表格，如果每页都有相同的表头，保留一个就行，表格中每个数据可能占多行，甚至存在分页现象，请保证数据的完整性，不要被水印干扰，生成纯文本返回给我，每行对应表格中的每行，不同元素之间用空格隔开。
```

### 第三步：粘贴豆包返回的结果

1. 豆包返回结果后，**完整复制**豆包输出的纯文本
2. 粘贴到主页面的**步骤二**大文本框中
3. 确保格式正确：
   - 每一行对应表格中的一行
   - 列与列之间用空格分隔（可以是一个或多个空格）
   - 不要有空行或说明文字

### 第四步：生成Excel

1. 检查文本框中的内容是否正确
2. 点击"**生成Excel**"按钮
3. 系统会自动：
   - 解析文本为表格结构
   - 第一行作为表头
   - 后续行作为数据
   - 生成Excel文件
   - 保存到历史记录

4. 生成成功后：
   - 页面下方会显示"最近一次生成"的记录
   - 可以点击"下载Excel"直接下载
   - 可以点击"查看历史记录"查看所有记录

### 第五步：查看历史记录

1. 点击顶部导航栏的"历史记录"
2. 可以看到所有生成过的记录，按时间倒序排列
3. 每条记录可以：
   - 查看原始文本
   - 下载Excel文件

## ? 使用技巧

### 1. 分屏操作
- **左屏**：打开本工具（`localhost:5173`）
- **右屏**：打开PDF阅读器 + 豆包网页版
- 这样可以方便对照检查数据

### 2. 文本格式要求
豆包返回的文本格式应该是：
```
列1 列2 列3 列4
数据1 数据2 数据3 数据4
数据1 数据2 数据3 数据4
```

**注意：**
- ? 列之间用空格分隔（可以多个空格）
- ? 每行对应一条记录
- ? 不要有空行
- ? 不要有说明文字
- ? 不要有特殊符号（如制表符、逗号等）

### 3. 如果解析失败
- 检查文本格式是否符合要求
- 确保第一行是表头
- 确保每行的列数一致（不一致会自动补齐）
- 检查是否有特殊字符干扰

## ? 常见问题

### Q: 后端启动失败？
A: 检查：
- Python版本是否为3.11
- 虚拟环境是否激活
- 依赖是否安装完整：`pip install -r requirements.txt`

### Q: 前端启动失败？
A: 检查：
- Node.js版本是否16+
- 依赖是否安装：`npm install`
- 端口5173是否被占用

### Q: 数据库错误？
A: 运行 `python backend/init_db.py` 重新初始化数据库

### Q: Excel生成失败？
A: 检查：
- 文本格式是否正确
- 是否有足够的磁盘空间
- 后端日志查看具体错误信息

## ? 项目结构

```
表格提取工具/
├── backend/          # 后端代码
│   ├── app.py       # Flask主应用
│   ├── models.py    # 数据模型
│   ├── auth.py      # 用户认证
│   ├── excel_utils.py  # Excel生成工具
│   └── requirements.txt  # Python依赖
├── frontend/        # 前端代码
│   └── src/
│       └── views/
│           ├── Home.vue      # 主页面
│           ├── History.vue   # 历史记录
│           ├── Login.vue     # 登录页
│           └── Register.vue  # 注册页
└── uploads/         # 上传文件目录（Excel存储在这里）
    └── excel/       # Excel文件存储
```

## ? 核心功能

- ? 用户注册/登录
- ? 提示词一键复制
- ? 纯文本解析为表格
- ? 自动生成Excel
- ? 历史记录管理
- ? Excel文件下载

## ? 注意事项

1. **不需要上传文件**：所有文件处理都在豆包中完成
2. **文本格式很重要**：确保豆包返回的格式符合要求
3. **历史记录会保存**：所有生成的记录都会保存，可以随时查看和下载
4. **Excel文件位置**：生成的Excel保存在 `uploads/excel/` 目录

---

**祝你使用愉快！** ?




